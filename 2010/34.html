<!doctype html><html lang=zh-cn><head><meta charset=utf-8><title>Southeastern European 2008 Sky Code 解题报告|I'm OWenT</title>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=canonical href=//owent.net/2010/34.html><link rel=icon href=../favicon.ico><link rel=stylesheet href=//unpkg.com/bootstrap@latest/dist/css/bootstrap.min.css crossorigin=anonymous><link rel=stylesheet href=//owent.net//css/style.css><link rel=stylesheet href=//owent.net/css/syntax.css><script type=importmap>
{
  "imports": {
    "react": "//unpkg.com/react@latest",
    "react-bootstrap": "//unpkg.com/react-bootstrap@latest",
    "mermaid": "//unpkg.com/mermaid@latest/dist/mermaid.esm.min.mjs",
    "bootstrap": "//unpkg.com/bootstrap@latest/dist/js/bootstrap.esm.min.js",
    "@popperjs/core": "//unpkg.com/@popperjs/core@latest/dist/esm/popper.js"
  }
}
</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8180054975285991" crossorigin=anonymous></script><meta name=baidu-site-verification content="codeva-4M5iohb9TW"></head><body><div id=container><div id=wrap><header id=header><div id=banner></div><div id=header-outer><div id=header-title><h1 id=site-title><a href=//owent.net/ id=logo>I'm OWenT</a></h1><h2 id=site-description>Challenge Everything</h2></div><div id=header-inner><nav id=main-nav class="navbar navbar-expand-md navbar-dark"><button class="navbar-toggler navbar-toggler-right" type=button data-bs-toggle=collapse data-bs-target=#main-nav-links aria-controls=main-nav-links aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<a id=main-nav-brand class="navbar-brand collapse" href=#>#</a><div class="collapse navbar-collapse position-relative" id=main-nav-links><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=../ title=Home>Home</a></li><li class=nav-item><a class=nav-link href=../archives.html title=Archives>Archives</a></li><li class=nav-item><a class=nav-link href=../about.html title=About>About</a></li><li class="nav-item nav-ads ads-placeholder ads-container"><ins class="adsbygoogle ads_menu" style=display:block data-ad-client=ca-pub-8180054975285991 data-ad-slot=4450372783 data-ad-format=auto data-full-width-responsive=true></ins><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{setTimeout(function(){try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(e){console.log("Load adsbygoogle failed"),console.error(e)}},256)})</script></li></ul><div class="col-12 col-xl-2 col-lg-3 col-md-4" id=main-nav-search><form class=input-group method=get accept-charset=UTF-8 action=//www.bing.com/search><input type=hidden name=q1 value=site:owent.net>
<input class=form-control type=text placeholder=搜索 name=q>
<button class="btn btn-outline-secondary my-0" type=submit>搜索</button></form></div></div></nav></div></div></header><div id=main><section id=main-content><div id=post-content><article id=post-5eeefce6525a554a005d0bba36851307 class="article-panel article article-type-post" itemscope itemprop=blogPost><div class="article-panel-inner article-inner"><div class=article-inner><header class=article-header><h1 itemprop=name><a class=article-title href=//owent.net/2010/34.html target=_blank itemprop=url>Southeastern European 2008 Sky Code 解题报告</a></h1></header><hr><div id=toc class="well toc m-3 p-1 pr-1 pt-1 pb-2 float-md-right float-md-end"><nav id=TableOfContents><ul><li><a href=#description>Description</a></li><li><a href=#input>Input</a></li><li><a href=#output>Output</a></li><li><a href=#sample-input>Sample Input</a></li><li><a href=#sample-output>Sample Output</a></li></ul></nav><div class="ads-placeholder ads-container"><ins class="adsbygoogle ads_toc" style=display:block data-ad-client=ca-pub-8180054975285991 data-ad-slot=1249494377 data-ad-format=auto data-full-width-responsive=true></ins><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{setTimeout(function(){try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(e){console.log("Load adsbygoogle failed"),console.error(e)}},256)})</script></div></div><br><div class=article-entry itemprop=articleBody><p>又是我们的OJ</p><p>题目链接：</p><p><a href="http://www.cn210.com/onlinejudge/problemshow.php?pro_id=92">http://www.cn210.com/onlinejudge/problemshow.php?pro_id=92</a></p><h2 id=description>Description</h2><p>tancu likes space travels but he is a poor software developer and will never be able to buy his own spacecraft. That is why he is preparing to steal the spacecraft of Petru. There is only one problem - Petru has locked the spacecraft with a sophisticated cryptosystem based on the ID numbers of the stars from the Milky Way Galaxy. For breaking the system Stancu has to check each subset of four stars such that the only common divisor of their numbers is 1. Nasty, isn't it? Fortunately, Stancu has succeeded to limit the number of the interesting stars to N but, any way, the possible subsets of four stars can be too many. Help him to find their number and to decide if there is a chance to break the system.</p><h2 id=input>Input</h2><p>For each test case on the first line the number N of interesting stars is given (1 ≤ N ≤ 10000). The second line of the test case contains the list of ID numbers of the interesting stars, separated by spaces. Each ID is a positive integer which is no greater than 10000. The input data terminate with the end of file.</p><h2 id=output>Output</h2><p>For each test case the program should print one line with the number of subsets with the asked property.</p><h2 id=sample-input>Sample Input</h2><pre><code>4
2 3 4 5
4
2 4 6 8
7
2 3 4 5 7 6 8
</code></pre><h2 id=sample-output>Sample Output</h2><pre><code>1
0
34
</code></pre><p>这题是数学题，要用到组合公式和容斥原理</p><p>要求最大公约数为1的4个数字的组合数量，由于有C(n,4)种取法，数量非常巨大不能枚举</p><p>其实所求的组合的个数等于所有的组合减去最大公约数大于1的组合</p><p>然后对于每个数比如2能整除a个数,3能整除b个数,6能整除c个数</p><p>显然结果是C(4,a) + C(4,b) - C(4,c)</p><p>类似的，最终结果是，对于所有的n（n满足是几个不同素数的积）</p><p>能被奇数个数整除的n的组合数减去能被偶数个数整除的n的组合数既是公约数大于1的组合的数量</p><p>即，令k(n)为能整除n的数的个数,p(n)是n的质因子个数，共有s个数</p><p>res = C(4,s) - ΣC(4,k(n))(-1)^p(n)</p><p>需要注意的地方有二点：</p><p>第一，复杂度必须控制在n * sqrt(n),否则会超时</p><p>第二，可以取出所有类似4这样等于素数的多次方的数的判定，以节省时间</p><p>代码如下：</p><pre><code class=language-cpp>#include &lt;cstdio&gt;
#include &lt;iostream&gt;
#include &lt;cstring&gt;
//#include &lt;ctime&gt;
using namespace std;

//Prime_Template_Var_Begin
const long MAXP = 10000;
long prime[MAXP] = {0},num_prime = 0;
int isNotPrime[MAXP] = {1, 1};
//Prime_Template_Var_End
int icCount[10005] = {0};
long long C4[10005] = {0};
long countNum[10005];
int main()
{
    //freopen(&quot;d:\\b.in&quot;, &quot;r&quot;, stdin);
    //clock_t tim_rcd = clock();

    long n, i, j, maxnum;
    long count;
    long long psn, res;
    //Prime_Begin
    for(i = 2 ; i &lt;  MAXP ; i ++)
    {
        if(! isNotPrime[i])
            prime[num_prime ++]=i;
        for(j = 0 ; j &lt; num_prime &amp;&amp; i * prime[j] &lt;  MAXP ; j ++)
        {
            isNotPrime[i * prime[j]] = 1;
            if( !(i % prime[j]))
                break;
        }
    }
    //Prime_End
    //Par_Count_Begin
    for(i = 0; i &lt; num_prime; i ++)
    {
        icCount[ prime[i] ] = 1;
        for(j = 2; j &lt; 10005 &amp;&amp; j * prime[i] &lt; 10005; j ++)
        {
            if(j % prime[i] &amp;&amp; icCount[j])
                icCount[j * prime[i]] = icCount[j] + 1;
        }
    }
    for(j = 2; j &lt; 10005; j ++)
        if(icCount[j])
            icCount[j] = (icCount[j] % 2)? 1: -1;
    //Par_Count_End
    //Count_C4_Begin
    for(i = 4; i &lt; 10005; i ++)
        C4[i] = ((long long)((i) * (i - 1) / 2) * (long long)(i - 2) / 3) * (long long)(i - 3) / 4;
    //Count_C4_End
    while(scanf(&quot;%ld&quot;, &amp;n) != EOF)
    {
        maxnum = 0;
        memset(countNum, 0, sizeof(countNum));
        for(i = 0; i &lt; n; i ++)
        {
            scanf(&quot;%ld&quot;, &amp;count);
            maxnum = (maxnum &gt; count)? maxnum: count;
            countNum[count] ++;
            for(j = 2; j * j &lt;= count; j ++)
            {
                if(count % j == 0)
                {
                    countNum[j] ++;
                    if(j * j != count)
                        countNum[count / j] ++;
                }
            }
        }
        if(n &lt; 4)
        {
            printf(&quot;0\n&quot;);
            continue;
        }
        psn = 0;
        for(i = 2; i &lt;= maxnum; i ++)
        {
            if(!icCount[i])
                continue;
            psn += icCount[i] * C4[countNum[i]];
        }
        res = C4[n];
        printf(&quot;%lld\n&quot;, res - psn);
    }

    //cout&lt;&lt; (clock() - tim_rcd) * 1000 / CLK_TCK &lt;&lt; endl;
    return 0;
}
</code></pre></div><hr><footer class=article-footer><div class="article-panel-footer article-meta article-footer clearfix"><span class=article-meta-left><ol><li><a href=//owent.net/categories/article.html>Article</a></li><li><a href=//owent.net/categories/my-acm-icpc-career.html>My ACM-ICPC Career</a></li></ol></span><span class=article-meta-right><time datetime=2010-04-29T12:08:10.000+00:00 itemprop=datePublished>2010-04-29</time></span>
<span class=clearfix></span></div><div class=article-tags><ul class=article-tag-list><li class=article-tag-list-item><a href=//owent.net/tags/acm.html>acm</a></li></ul></div></footer><div class="ads-placeholder ads-container"><ins class="adsbygoogle ads_infeed" style=display:block data-ad-client=ca-pub-8180054975285991 data-ad-slot=5599802929 data-ad-format=auto data-full-width-responsive=true></ins><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{setTimeout(function(){try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(e){console.log("Load adsbygoogle failed"),console.error(e)}},256)})</script></div></div><hr><nav id=article-nav><ul class=pagination><li class=page-item><a class=page-link id=article-nav-newer class=article-nav-link-wrap href=//owent.net/2010/33.html>上一篇<strong>HDU HDOJ 3400 Line belt 解题报告</strong></a></li><li class=page-item><a class=page-link id=article-nav-older class=article-nav-link-wrap href=//owent.net/2010/35.html>下一篇<strong>GCD Determinant 解题报告</strong></a></li></ul></nav><hr><script src=https://utteranc.es/client.js repo=owent/blog-website issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></article></div></section></div><footer id=footer><div class=outer><div id=footer-info class="inner clearfix"><strong id=footer-left class="float-left float-start"><a rel=license href=https://github.com/owent/blog-hugo/blob/master/LICENSE.md><img alt=知识共享许可协议 style=border-width:0 src=https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png></a>
2024
OWenT
</strong><strong id=footer-right class="float-right float-end"><a href=https://github.com/owent/blog-hugo target=_blank>本站源码</a>,
发布者 <a href=https://gohugo.io/ target=_blank>Hugo</a>,
主题 <a href=https://github.com/owent/hugo-theme-distinctionpp target=_blank>distinctionpp</a>
</strong><span class=clearfix></span></div></div></footer></div><script type=module>
import * as Popper from "@popperjs/core";
import * as bootstrap from 'bootstrap';
// import React from "react";

</script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/highlight.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/awk.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/bash.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/cpp.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/capnproto.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/cmake.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/d.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/diff.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/dockerfile.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/dos.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/erlang.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/go.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/less.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/llvm.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/lua.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/php.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/powershell.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/protobuf.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/python.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/profile.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/typescript.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/vim.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/rust.min.js></script><script type=text/javascript src=//unpkg.com/@highlightjs/cdn-assets@latest/languages/yaml.min.js></script><script type=text/javascript>document.addEventListener("DOMContentLoaded",e=>{const t=document.createElement("link");t.rel="stylesheet",t.href="//unpkg.com/@highlightjs/cdn-assets@latest/styles/vs2015.min.css",document.querySelector("head").appendChild(t),window.JSON?hljs.configure(JSON.parse('{"ignoreunescapedhtml":true,"languages":{},"tabreplace":"    ","throwunescapedhtml":false,"usebr":false}')):hljs.configure(evel('{"ignoreunescapedhtml":true,"languages":{},"tabreplace":"    ","throwunescapedhtml":false,"usebr":false}'));const n={};for(const e of hljs.listLanguages())n[e.toLowerCase()]=!0;for(const e of document.querySelectorAll("pre>code"))try{if(e.className.match(/\bmermaid\b/i)){e.classList.add("mermaid");continue}if(e.className.match(/\bnohighlight\b/i))continue;const t=e.className.match(/language-([^\s]+)/i);if(t&&t.length>=2&&hljs.getLanguage(t[1]))hljs.highlightElement(e);else{const t=hljs.highlightAuto(e.innerText,hljs.listLanguages());t&&t.value&&(e.innerHTML=t.value,e.classList.add("hljs"))}}catch(e){window.console&&console.log(e.toString()+`\r
Maybe can not detect the language`)}})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-PQEY77BYG1"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PQEY77BYG1")}</script><script type=text/javascript src=//unpkg.com/katex@latest/dist/katex.min.js></script><script type=text/javascript src=//unpkg.com/katex@latest/dist/contrib/auto-render.min.js></script><script type=text/javascript>document.addEventListener("DOMContentLoaded",e=>{const t=document.createElement("link");t.rel="stylesheet",t.href="//unpkg.com/katex@latest/dist/katex.min.css",document.querySelector("head").appendChild(t),renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"$",right:"$",display:!1}],throwOnError:!1,ignoredTags:["script","noscript","style","textarea","pre","code"]})})</script><script type=text/javascript src=//unpkg.com/chart.js@latest/dist/chart.umd.js></script><script type=module>
import mermaid from "mermaid";
const config = {
    theme: 'neutral',
    logLevel: 'fatal',
    securityLevel: 'loose', 
    startOnLoad: true,
    arrowMarkerAbsolute: false,
    

};
mermaid.initialize(config);
</script></div></body></html>